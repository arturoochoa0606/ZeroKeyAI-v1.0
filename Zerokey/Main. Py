"""Main entry point for ZeroKeyAI."""
import argparse
import logging
from .utils.logger import get_logger
from .utils.helpers import ensure_dir, load_json, load_yaml
import os

logger = get_logger(__name__)


def parse_args():
    parser = argparse.ArgumentParser(description="ZeroKeyAI main runner")
    parser.add_argument("--config", help="Path to config.json", default="config/config.json")
    parser.add_argument("--settings", help="Path to settings.yml", default="config/settings.yml")
    return parser.parse_args()


def main():
    args = parse_args()

    # ensure folders
    ensure_dir("logs")
    ensure_dir("data")
    ensure_dir("temp")

    # load config
    try:
        cfg = load_json(args.config)
        settings = load_yaml(args.settings)
    except Exception as e:
        logger.error("Failed to load configuration: %s", e)
        return 1

    logger.info("Starting ZeroKeyAI v%s", cfg.get("version", "?"))
    logger.info("Environment: %s", settings.get("app", {}).get("environment"))

    # here goes the main orchestration logic
    logger.info("Initialization complete. Add your tasks in zerokey/main.py")

    return 0


if __name__ == "__main__":
    exit(main())
